@using Sandbox;
@using Sandbox.UI;
@using TacticsRPG;
@inherits PanelComponent
@namespace Sandbox

<root>
</root>

@code
{
	private Queue<IFloatingElement> Elements = new Queue<IFloatingElement>();
	private List<Panel> ActiveElements = new List<Panel>();

	protected override void OnStart()
	{

	}

	[Button("DamageTest")]
	public void ElemTest()
	{
		CreateFloatingText(999.ToString(), new Color(1.00f, 1.00f, 1.00f, 1.00f));
	}

	public void CreateFloatingText(string text, Color color)
	{
		var ft = new FloatingText(text, "ThaleahFat", 60, color, () => new CharAnimationSequence(new BounceInAnimation(), new FadeOutAnimation(0.5f)));
		ft.Obj = this.GameObject.Parent;
		Panel.AddChild(ft);
		ft.Start();
	}

	private void AddElem()
	{
		var elem = Elements.Dequeue() ;
		Panel.AddChild((Panel)elem);
		ActiveElements.Add((Panel)elem);
		elem.Start();
	}

	protected override void OnUpdate()
	{
		if(Elements.Any())
		{
			AddElem();
		}
	}

	protected override int BuildHash() => System.HashCode.Combine(RealTime.Now);
}
